extends ../layout.pug
block othercss
    link(rel='stylesheet', href='/stylesheets/business/admin.css')
block content
    div(style="text-align:right;margin-bottom:15px;")
        span 当前用户 #{adminName} &nbsp;&nbsp;&nbsp;&nbsp;
        a(href="/admin/logout") 登出
    div(id="worksarea" v-bind:style="{height: calcHeight + 'px'}" class="div-border")
        el-container(v-bind:style="{height: containerHeight + 'px'}")
            el-aside(v-bind:style="{height: asideHeight + 'px'}")
                el-menu(:default-openeds="['1','2']" v-bind:style="{height: asideHeight + 'px'}" collapse=false)
                    el-submenu(index="1")
                        template(slot="title")
                            i(class="el-icon-menu")
                            span 数据一览
                        el-menu-item-group
                            el-menu-item(index="1-1" @click="gofunc(0)") 进件明细
                            el-menu-item(index="1-2" @click="gofunc(1)") 短信明细
                    el-submenu(index="2")
                        template(slot="title")
                            i(class="el-icon-setting")
                            span 系统设置
                        el-menu-item-group
                            el-menu-item(index="2-2" @click="gofunc(2)") 用户管理
                            el-menu-item(index="2-3" @click="gofunc(3)") 重置密码
            el-main(v-bind:style="{height: mainHeight + 'px'}")
                el-dialog(:title="oper",:visible.sync="dialogVisible",width="25%",:before-close="beforeCancelAddAdmin")
                    el-row
                        el-col(:span="6" style="text-align:right;")
                            div(style="line-height:3") 姓名
                        el-col(:span="18" style="text-align:left;")
                            el-input(v-model="beanAdmName",placeholder="请输入管理员姓名", maxlength="32" style="width:210px;margin-left:15px;",type="input" autofocus="true")
                    el-row
                    el-row
                        el-col(:span="6" style="text-align:right;")
                            div(style="line-height:3") 手机
                        el-col(:span="18" style="text-align:left;")
                            el-input(v-model="beanAdmMobile",placeholder="请输入管理员手机", maxlength="32" style="width:210px;margin-left:15px;",type="input" autofocus="true")
                    el-row
                    el-row
                        el-col(:span="6" style="text-align:right;")
                            div(style="line-height:3") 账号
                        el-col(:span="18" style="text-align:left;")
                            el-input(v-model="beanAdmAcc",placeholder="请输入管理员账号", maxlength="32" style="width:210px;margin-left:15px;",type="input" autofocus="true")
                    el-row
                    el-row
                        el-col(:span="6" style="text-align:right;")
                            div(style="line-height:3") 密码
                        el-col(:span="18" style="text-align:left;")
                            el-input(v-model="beanAdmPwd",placeholder="请输入管理员密码", show-password, maxlength="32" style="width:210px;margin-left:15px;",type="input" autofocus="true")
                    el-row
                    el-row
                        el-col(:span="6" style="text-align:right;")
                            div(style="line-height:3") 状态
                        el-col(:span="18" style="text-align:left;")
                            el-checkbox(v-model="beanAdmStat",style="margin-left:15px;line-height:3",chec) 启用
                    el-row
                    el-row
                        el-col(:span="12" style="text-align:right;")
                            el-button(@click="editAdmin" style="margin-right:10px;") 确定
                        el-col(:span="12" style="text-align:left;")
                            el-button(@click="cancelAddAdmin()" style="margin-left:5px;") 取消
                el-tabs(v-model="activeTabIndex" type="card" closable=true @tab-remove="tabRemoved" @tab-click="tabClicked")
                    el-tab-pane(label="进件明细" name="0")
                        <!--如果不绑定value-format，那么这个控件默认输出的是Date对象-->
                        el-date-picker(align="right" type="date" placeholder="选择开始日期" class="datepicker" v-model="requestBeginDate" value-format="yyyy-MM-dd")
                        el-date-picker(align="right" type="date" placeholder="选择结束日期" class="datepicker" v-model="requestEndDate" value-format="yyyy-MM-dd")
                        el-button(icon="el-icon-search" @click="qryWithCondition()") 查询
                        el-button(icon="el-icon-delete" @click="clearSearchConditions()") 清除查询条件
                        el-table(border style="width:100%" :data="reqDataSet")
                            el-table-column(label="请求编号" width="180" class="column-title" prop="req_id")
                            el-table-column(label="请求时间" width="180" class="column-title" prop="req_time")
                            el-table-column(label="报文信息" prop="raw_msg")
                            el-table-column(label="应答结果" width="180" class="column-title" prop="rs_status")
                        el-pagination(:current-page="currentPage" :page-size="pageSize" layout="total, prev, pager, next, jumper" :total="totalCount" class="rqpagination" @current-change="goPage")
                    el-tab-pane(label="短信明细" name="1")
                        el-date-picker(align="right" type="date" placeholder="选择开始日期" class="datepicker" v-model="smsBeginDate" value-format="yyyy-MM-dd")
                        el-date-picker(align="right" type="date" placeholder="选择结束日期" class="datepicker" v-model="smsEndDate" value-format="yyyy-MM-dd")
                        el-button(icon="el-icon-search" @click="qrySmsWithCondition()") 查询
                        el-button(icon="el-icon-delete" @click="clearSmsSearchConditions()") 清除查询条件
                        el-table(border style="width:100%" :data="smsDataSet")
                            el-table-column(label="短信编号" width="180" class="column-title" prop="req_id")
                            el-table-column(label="发送时间" width="180" class="column-title" prop="req_time")
                            el-table-column(label="报文信息" prop="raw_msg")
                            el-table-column(label="下行状态" width="180" class="column-title" prop="rs_status")
                        el-pagination(:current-page="smsCurrentPage" :page-size="smsPageSize" layout="total, prev, pager, next, jumper" :total="smsTotalCount" class="rqpagination" @current-change="goSmsPage")
                    el-tab-pane(label="用户管理" name="2")
                        el-button(icon="el-icon-circle-plus-outline" @click="showAddAdminDialog()" style="margin-bottom:5px;") 增加管理员
                        el-table(border style="width:100%" :data="merAdminDataSet")
                            el-table-column(label="用户编号" width="80" class="column-title" prop="admin_id")
                            el-table-column(label="用户姓名" width="100" class="column-title" prop="admin_name")
                            el-table-column(label="用户手机" width="120" class="column-title" prop="admin_mobile")
                            el-table-column(label="用户账号" width="120" class="column-title" prop="admin_acc")
                            el-table-column(label="创建时间" width="180" class="column-title" prop="created_time")
                            el-table-column(label="修改时间" width="180" class="column-title" prop="modified_time")
                            el-table-column(label="是否超管" width="80" class="column-title" prop="is_root")
                            el-table-column(label="当前状态" width="80" class="column-title" prop="admin_status")
                            el-table-column(label="操作" class="column-title")
                                template(slot-scope="scope")
                                    el-button(@click="changeAdminState(scope.$index, scope.row,1)") 启用
                                    el-button(@click="changeAdminState(scope.$index, scope.row,0)") 禁用
                                    el-button(@click="showModifyAdminDialog(scope.$index, scope.row)") 修改信息
                                    el-button() 删除
                        el-pagination(:current-page="meradmcurrentPage" :page-size="meradmpageSize" layout="total, prev, pager, next, jumper" :total="meradmTotalCount" class="rqpagination" @current-change="goMerAdmPage")
                    el-tab-pane(label="重置密码" name="3")
                        el-row(class="rowclaz")
                            el-col(:span="24")
                                el-input(v-model="oldPwd",placeholder="请输入原始密码",show-password,style="width:300px;margin-left:15px;",type="input")
                                    template(slot="prepend") 旧的密码
                        el-row(class="rowclaz")
                            el-col(:span="24")
                                el-input(v-model="newPwd",placeholder="请输入新密码",show-password,style="width:300px;margin-left:15px;",type="input")
                                    template(slot="prepend") 新的密码
                        el-row(class="rowclaz")
                            el-col(:span="24")
                                el-input(v-model="newPwdAffirm",placeholder="请再次输入新密码",show-password,style="width:300px;margin-left:15px;",type="input")
                                    template(slot="prepend") 确认密码
                        el-row
                            el-col(:span="24")
                                el-button(@click="goResetPwd" style="margin-left:130px;") 确定
    script(src="/javascripts/business/admin.js")